version: 1

#basedir: 'TEMP'

basedir_cleanup: 0

log: te.log

servers:

    maindb:
        type: MySQL
        config:
            mysqld:
                port: $maindb_port$
                bind-address: $maindb_ip$
                socket: $maindb_sock$
            innodb:
                innodb_buffer_pool_size: 64M
        databases:
          - name: maindb
            scheme: maindb.sql
        users:
          - name: mainuser
            pass: mainpass
            grant: maindb

    tnt_shard1:
        type: Tarantool
        config:
            listen: $tnt1_addr$
        lua_script: shard.lua

    tnt_shard2:
        type: Tarantool
        config:
            listen: $tnt2_addr$
        lua_script: shard.lua

    swa:
        type: mailru.SWA
        ip:   $swa_ip$
        port: $swa_port$

    souz:
        type: mailru.Souz
        ip:   $souz_ip$
        port: $souz_port$

    wsd:
        #type: mailru.WSD
        type: GenericServer
        command: '../../games-social/bin/wsd --config=wsd.conf --shard_config=wsd.conf --interactive'
        configtype: ini
        configfile: wsd.conf
        config:
            listen_ws: $wsd_ws_addr$
            listen_int: $wsd_int_addr$
            shard_total: 1
            shard_id: 0
            allowed_origin: 127.0.0.1
            #sociald_shards: $sociald_addr$
            #sociald_api_client: '0'
            #sociald_api_secret: 'nobodyknows'
            #sociald_pool: 1
        stdout: wsd.log
        stderr: wsd.log

    sociald:
        #type: mailru.Sociald
        type: GenericServer
        command: '../../games-social/bin/sociald --config=sociald.conf --instance_config=sociald.conf --interactive'
        configfile: sociald.conf
        configtype: ini
        config:
            listen: $sociald_addr$
            tnt_shards: $tnt1_addr$,$tnt2_addr$
            wsd_shards: $wsd_int_addr
            my_igrek_masters: 94.100.191.17:5054
            swa_addr: $swa_addr
            souz_addr: $souz_addr
            souz_id: '0'
            souz_secret: 'doesnotmatter'
            dbms: mysql
            db_name: maindb
            db_host: $maindb_ip$
            db_port: $maindb_port$
            db_login: mainuser
            db_pass: mainpass
        stdout: sociald.log
        stderr: sociald.log

extra:
    sociald_conf: $basedir$/sociald/sociald.conf
